title = "Listado de León"
url = "/listado-de-leon"
layout = "default"
is_hidden = 0

[session]
security = "user"
allowedUserGroups[] = "administrador"
allowedUserGroups[] = "supervisor"
redirect = "iniciar-sesion"
==
<?php
function onStart(){
    $this['leones']=new class {
        public function leon(){
            $data= Db::select('select codigoleon, cedula, primernombre, primerapellido, telefonocelular, id_correoleon from club_usuarioleon order by primernombre', [1]);
                  
            foreach($data as $data1) 
                {echo "<tr>";
                    foreach($data1 as $key=>$data2)
                        { 
                             if ($key=='codigoleon')
                             {$var=$data2;}
                            echo "<td>$data2</td>";
                        }
                echo "<td>
                        <a type='submit' name='variable' onclick='return confirmDel()'>Eliminar|</a>
                        <a href='#' type='submit' name='variable'>Editar</a>
                    </td>";
                     
                echo "</tr>";
                }
                  
                            }
                                };
}  

function onEliminar(){
    $var=$_POST('variable');
    $deleted = Db::delete('delete ? = codigoleon from club_usuarioleon',[$var]);
    }
?>
==
{% component 'session' %}

{% put scripts %}
    <script src="{{ [
        'assets/javascript/pages/ui-elements.js',
    ]|theme }}"></script>
{% endput %}
{%put scripts%}
<script language="javascript">
        function doSearch()
        {
            const tableReg = document.getElementById('datos');
            const searchText = document.getElementById('searchTerm').value.toLowerCase();
            let total = 0;
 
            // Recorremos todas las filas con contenido de la tabla
            for (let i = 1; i < tableReg.rows.length; i++) {
                // Si el td tiene la clase "noSearch" no se busca en su cntenido
                if (tableReg.rows[i].classList.contains("noSearch")) {
                    continue;
                }
 
                let found = false;
                const cellsOfRow = tableReg.rows[i].getElementsByTagName('td');
                // Recorremos todas las celdas
                for (let j = 0; j < cellsOfRow.length && !found; j++) {
                    const compareWith = cellsOfRow[j].innerHTML.toLowerCase();
                    // Buscamos el texto en el contenido de la celda
                    if (searchText.length == 0 || compareWith.indexOf(searchText) > -1) {
                        found = true;
                        total++;
                    }
                }
                if (found) {
                    tableReg.rows[i].style.display = '';
                } else {
                    // si no ha encontrado ninguna coincidencia, esconde la
                    // fila de la tabla
                    tableReg.rows[i].style.display = 'none';
                }
            }
 
            // mostramos las coincidencias
            const lastTR=tableReg.rows[tableReg.rows.length-1];
            const td=lastTR.querySelector("td");
            lastTR.classList.remove("hide", "red");
            if (searchText == "") {
                lastTR.classList.add("hide");
            } else if (total) {
                td.innerHTML="Se ha encontrado "+total+" coincidencia"+((total>1)?"s":"");
            } else {
                lastTR.classList.add("red");
                td.innerHTML="No se han encontrado coincidencias";
            }
        }
                   function confirmDel(){
                      var agree=confirm('¿Realmente desea eliminarlo?');
                  if (agree) return true ;
                  return false;} 
    </script>
{%endput%}
<style>
  #line {
    display: inline;
  }
</style>

<section id="layout-title">
  <div class="container">
    <h3 style="text-align: center">Listado de leones</h3>
  </div>
</section>

<div class="col-sm-2">
  <a class="btn btn-block btn-lg btn-primary" VALUE="Volver" onClick="history.back()">Regresar</a>
</div>

<form>
        <div class="col-sm-3">
            <input placeholder="Buscar" class="form-control"  id="searchTerm" type="text" onkeyup="doSearch()" />
        </div>
</form>
<p>&nbsp;</p>
<p>&nbsp;</p>

<style>
  table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    border: 1px solid #ddd;
  }

  th,
  td {
    text-align: left;
    padding: 8px;
  }

  tr:nth-child(even) {
    background-color: #f2f2f2;
  }
</style>

<div style="overflow-x:auto;">
  <table id="datos">
    <tr>
      <th>Codigo leon</th>
      <th>Cedula</th>
      <th>Nombre</th>
      <th>Apellido</th>
      <th>Celular</th>
      <th>Correo</th>
      <th>Editar</th>
    </tr>
    {{leones.leon}}
    <tr class='noSearch hide'>
        <td colspan="5"></td>
    </tr>

  </table>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>