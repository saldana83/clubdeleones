title = "Listado de pagos por león"
url = "/listado-de-pagos-por-leon"
layout = "default"
is_hidden = 0

[session]
security = "user"
allowedUserGroups[] = "administrador"
allowedUserGroups[] = "supervisor"
redirect = "iniciar-sesion"
==
<?php
function onStart(){
    $this['pagos']=new class {
        public function pa(){
            $data= Db::select('select codigo_pago,cedula,nombredepago, categoria, descripcion, monto from club_historial_de_pagos
            INNER JOIN club_usuarioleon ON club_usuarioleon.cedula=club_historial_de_pagos.cedula_leon
            INNER JOIN club_tiposdepagos ON club_historial_de_pagos.codigo_de_pago=club_tiposdepagos.codigo_pago', [1]);
                  
            foreach($data as $data1) 
                {echo "<tr>";
                    foreach($data1 as $data2)
                        { 
                            echo "<td>$data2</td>";
                        }
                echo "</tr>";
                }
                  
                            }
                                };
}
?>
==
{% component 'session' %}

{% put scripts %}
    <script src="{{ [
        'assets/javascript/pages/ui-elements.js',
    ]|theme }}"></script>
{% endput %}
{%put scripts%}
<script language="javascript">
        function doSearch()
        {
            const tableReg = document.getElementById('datos');
            const searchText = document.getElementById('searchTerm').value.toLowerCase();
            let total = 0;
 
            // Recorremos todas las filas con contenido de la tabla
            for (let i = 1; i < tableReg.rows.length; i++) {
                // Si el td tiene la clase "noSearch" no se busca en su cntenido
                if (tableReg.rows[i].classList.contains("noSearch")) {
                    continue;
                }
 
                let found = false;
                const cellsOfRow = tableReg.rows[i].getElementsByTagName('td');
                // Recorremos todas las celdas
                for (let j = 0; j < cellsOfRow.length && !found; j++) {
                    const compareWith = cellsOfRow[j].innerHTML.toLowerCase();
                    // Buscamos el texto en el contenido de la celda
                    if (searchText.length == 0 || compareWith.indexOf(searchText) > -1) {
                        found = true;
                        total++;
                    }
                }
                if (found) {
                    tableReg.rows[i].style.display = '';
                } else {
                    // si no ha encontrado ninguna coincidencia, esconde la
                    // fila de la tabla
                    tableReg.rows[i].style.display = 'none';
                }
            }
 
            // mostramos las coincidencias
            const lastTR=tableReg.rows[tableReg.rows.length-1];
            const td=lastTR.querySelector("td");
            lastTR.classList.remove("hide", "red");
            if (searchText == "") {
                lastTR.classList.add("hide");
            } else if (total) {
                td.innerHTML="Se ha encontrado "+total+" coincidencia"+((total>1)?"s":"");
            } else {
                lastTR.classList.add("red");
                td.innerHTML="No se han encontrado coincidencias";
            }
        }
    </script>
{%endput%}
<style>
    table {
        border-collapse: collapse;
        border-spacing: 0;
        margin: 0 auto;
        width: 100%;
        border: 1px solid #ddd;
    }

    th,
    td {
        text-align: left;
        padding: 8px;
    }

    tr:nth-child(even) {
        background-color: #f2f2f2
    }

    #line {
        display: inline;
    }

    button {
        background-color: #7E8B8C;
        /* Green */
        border: none;
        color: white;
        padding: 1%;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 8px;
    }
</style>

<section id="layout-title">
    <div class="container">
        <h3 style="text-align: center">Listado de pagos</h3>
    </div>
</section>

<div class="col-sm-2">
    <a class="btn btn-block btn-lg btn-primary" VALUE="Volver" onClick="history.back()">Regresar</a>
</div>

<p>&nbsp;</p>

<div style="margin-right:auto;margin-left:auto;width: 300px;">
            <input placeholder="Buscar" class="form-control"  id="searchTerm" type="text" onkeyup="doSearch()" />
</div>

    <p>&nbsp;</p>
    <div style="overflow-x:auto;">
        <table id="datos">
            <tr>
                <th>Codigo de Pago</th>
                <th>Cedula león</th>
                <th>Nombre de Pago</th>
                <th>Categoria</th>
                <th>Descripci&oacute;n</th>
                <th>Monto</th>
            </tr>
            {{pagos.pa}}
            <tr class='noSearch hide'>
                <td colspan="5"></td>
            </tr>
        </table>
    </div>

    <p>&nbsp;</p>
    <div style="text-align: center">
        <button type="submit">Actualizar Pagos</button>
        <button type="submit">Seleccionar pagos pendientes</button>
    </div>
    <p>&nbsp;</p>

</form>